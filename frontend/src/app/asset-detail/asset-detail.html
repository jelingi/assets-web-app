<div class="container" *ngIf="asset$ | async as asset">

  <h2>Asset Details</h2>

  <p><strong>Name:</strong> {{ asset.name }}</p>
  <p><strong>Typ:</strong> {{ asset.type }}</p>
  <p><strong>Seriennummer:</strong> {{ asset.serialNumber }}</p>
  <p><strong>Status:</strong> {{ statusLabels[asset.status] || asset.status }}</p>

  <p><strong>Zugewiesen an:</strong> {{ asset.assignedTo || '-' }}</p>
  <p><strong>Standort:</strong> {{ asset.location || '-' }}</p>
  <p><strong>Notizen:</strong> {{ asset.notes || '-' }}</p>

  <div class="form-actions">
    <!-- ✔ BEARBEITEN = ROUTING -->
    <button
      class="primary"
      [routerLink]="['/assets', asset._id, 'edit']">
      Bearbeiten
    </button>

    <!-- ✔ LÖSCHEN = deleteAsset -->
    <button
      class="danger"
      (click)="deleteAsset(asset._id)">
      Löschen
    </button>
  </div>

  <h3>Historie</h3>

  <table *ngIf="asset.history?.length; else noHistory">
    <thead>
      <tr>
        <th>Zeitpunkt</th>
        <th>Aktion</th>
        <th>Änderungen</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let h of asset.history">
        <td>{{ h.at | date:'short' }}</td>
        <td>{{ h.action }}</td>
        <td>
          <div *ngFor="let c of h.changes">
            {{ c.field }}: {{ c.oldValue ?? '-' }} → {{ c.newValue ?? '-' }}
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-template #noHistory>
    <p>Keine Änderungen vorhanden.</p>
  </ng-template>

</div>

<p *ngIf="!(asset$ | async)">
  Lade Asset-Daten …
</p>
